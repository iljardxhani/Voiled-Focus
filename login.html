<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login • Voiled Program</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="login-body">
  <header class="login-page-header">
    <div class="login-page-title">LOGIN</div>
    <p class="login-page-sub">Access your programmed day — Google/password coming soon.</p>
  </header>
  <div class="login-grid">
    <section class="login-hero" aria-labelledby="loginHeroTitle">
      <div class="login-eyebrow">Login</div>
      <div class="login-hero-top">
        <span class="pill pill-positive">Prop login (stub)</span>
        <span class="login-meta">Google & password auth wiring soon • Keeps you in flow today</span>
      </div>
      <h1 id="loginHeroTitle">Return to your programmed day</h1>
      <p class="login-subhead">Prime your focus, then sign in once the real auth lands. For now, a prop login keeps the ritual and rhythm intact.</p>

      <p class="login-hints-label">Quick priming hints (so you know why they’re here)</p>
      <div class="login-bento">
        <div class="bento-card">
          <span class="hint-pill">Hint</span>
          <div class="bento-label">Today’s focus plan</div>
          <div class="bento-value">Pick 2–3 tasks to actually finish</div>
          <p class="bento-hint">Small, named targets stick. You can edit them once you’re in.</p>
        </div>
        <div class="bento-card">
          <span class="hint-pill">Hint</span>
          <div class="bento-label">You’re steering</div>
          <div class="bento-value accent">Plan first, react later</div>
          <p class="bento-hint">Set your agenda now; say no to random distractions.</p>
        </div>
        <div class="bento-card wide">
          <span class="hint-pill">Why this?</span>
          <div class="bento-label">Safety</div>
          <div class="bento-value">Local-only placeholder</div>
          <p class="bento-hint">No internet calls. Real Google + password auth will replace this soon.</p>
        </div>
      </div>
    </section>

    <section class="login-panel" aria-labelledby="propLoginTitle">
      <div class="login-card">
        <div class="login-card-head">
          <span class="prop-tag">Prop login placeholder</span>
          <h2 id="propLoginTitle">Enter a session identity</h2>
          <p class="login-card-copy">Use this to rehearse the sign-in flow. Nothing leaves your device; we will swap this for Google + password auth shortly.</p>
        </div>

        <button class="login-btn login-btn-google" type="button" aria-disabled="true">
          <span class="dot"></span>
          Continue with Google (coming soon)
        </button>
        <button class="ghost-btn login-btn-skip" type="button">Skip (test mode)</button>
        <p class="login-note">The Google button is intentionally inert. It signals the next integration while keeping today frictionless.</p>

        <div class="login-divider"><span>or use prop login</span></div>

        <form id="propLoginForm" class="login-form" novalidate>
          <label class="login-field" for="loginEmail">
            <span class="field-label">Focus email (prop)</span>
            <input id="loginEmail" name="email" type="email" class="text-input" placeholder="you@program.day" required autocomplete="email">
          </label>
          <label class="login-field" for="loginPass">
            <span class="field-label">Passphrase (prop)</span>
            <input id="loginPass" name="pass" type="password" class="text-input" placeholder="••••••••" required autocomplete="current-password">
          </label>

          <div class="login-inline">
            <label class="remember-toggle">
              <input id="rememberMe" type="checkbox" checked>
              <span>Remember this device for the day</span>
            </label>
            <button type="button" class="link-btn subtle-link" aria-label="Reset prop credentials">Reset prop</button>
          </div>

          <button type="submit" class="primary-btn login-submit">Enter the day</button>
        </form>

        <div class="login-status" id="propLoginStatus" role="status" aria-live="polite">
          Prop mode: creates a session locally. Auth hooks pending.
        </div>

        <div class="login-foot">
          <div class="login-foot-item">
            <span class="dot success"></span>
            <div>
              <div class="foot-label">Today’s promise</div>
              <div class="foot-value">Finish 1–3 tasks you can narrate in one line.</div>
            </div>
          </div>
          <div class="login-foot-item">
            <span class="dot accent"></span>
            <div>
              <div class="foot-label">Default tone</div>
              <div class="foot-value">Calm, deliberate, scheduled — not reactive.</div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    (function() {
      const form = document.getElementById('propLoginForm');
      const status = document.getElementById('propLoginStatus');
      const resetBtn = document.querySelector('.subtle-link');
      const emailEl = document.getElementById('loginEmail');
      const passEl = document.getElementById('loginPass');
      const googleBtn = document.querySelector('.login-btn-google');
      const skipBtn = document.querySelector('.login-btn-skip');

      googleBtn?.addEventListener('click', () => {
        window.location.href = '/api/auth/google';
      });

      skipBtn?.addEventListener('click', () => {
        if (status) {
          status.textContent = 'Skipping login (test mode only).';
          status.classList.add('visible');
        }
        try { localStorage.setItem('voiled_fake_auth_v1', 'true'); } catch {}
        try { window.parent?.postMessage({ type: 'fake-login' }, '*'); } catch {}
      });

      form?.addEventListener('submit', (event) => {
        event.preventDefault();
        if (status) {
          status.textContent = 'Redirecting to Google for sign in...';
          status.classList.add('visible');
        }
        window.location.href = '/api/auth/google';
      });

      resetBtn?.addEventListener('click', () => {
        if (emailEl) emailEl.value = '';
        if (passEl) passEl.value = '';
        if (status) {
          status.textContent = 'Session cleared. Ready to sign in again.';
          status.classList.add('visible');
        }
        try { window.parent?.postMessage({ type: 'prop-logout' }, '*'); } catch {}
        try { window.parent?.postMessage({ type: 'fake-logout' }, '*'); } catch {}
        try { localStorage.removeItem('voiled_fake_auth_v1'); } catch {}
        fetch('/api/logout', { method: 'POST', credentials: 'include' }).catch(() => {});
      });
    })();
  </script>
</body>
</html>
